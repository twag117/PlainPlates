{% extends "base.html" %}
{% block title %}{{ recipe.title }} - PlainPlates{% endblock %}

{% block content %}
<section class="max-w-4xl mx-auto px-4 py-8">
    <a href="/recipes"
        class="text-sm text-primary-600 hover:underline inline-block mb-4 -mt-5">
        ‚Üê Back to All Recipes
    </a>

    <h1 class="text-3xl font-bold mb-2">{{ recipe.title }}</h1>
    <p class="text-gray-600 mb-4">{{ recipe.description }}</p>

    <div class="mb-6 rounded overflow-hidden">
        <img src="/static/images/recipes{{ recipe.slug }}.jpg"
            onerror="this.onerror=null;this.src='https://placehold.co/400x200?text=Image Coming Soon'; this.classList.add('h-16');"
            alt="{{ recipe.title }}"
            class="w-full h-64 object-cover rounded">
    </div>



    <div class="flex items-center justify-between text-sm text-gray-500 mb-6">
        <span>Total Time: {{ recipe.prep_time + recipe.cook_time }} min</span>
        <span>Score: {% if recipe.score > 0 %}üî•{% else %}üßä{% endif %} {{ recipe.score }}</span>
    </div>

    {% if recipe.tags %}
    <div class="flex flex-wrap gap-2 mb-6">
        {% for tag in recipe.tags %}
        <span class="bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-xs">{{ tag }}</span>
        {% endfor %}
    </div>
    {% endif %}

    <div class="flex items-center gap-2 mb-6">
        <input type="checkbox" id="keep-awake" class="w-4 h-4">
        <label for="keep-awake" class="text-sm text-gray-600">
        Keep screen awake while viewing this recipe
        </label>
    </div>


    <h2 class="text-xl font-semibold mb-2">Ingredients</h2>
    <pre class="bg-gray-50 p-4 rounded text-sm whitespace-pre-wrap mb-6">{{ recipe.ingredients }}</pre>

    <h2 class="text-xl font-semibold mb-2">Instructions</h2>
    <pre class="bg-gray-50 p-4 rounded text-sm whitespace-pre-wrap mb-6">{{ recipe.instructions }}</pre>

    {% if recipe.notes %}
    <h2 class="text-xl font-semibold mb-2">Notes</h2>
    <pre class="bg-gray-50 p-4 rounded text-sm whitespace-pre-wrap">{{ recipe.notes }}</pre>
    {% endif %}
</section>

<script>
let wakeLock = null;

async function requestWakeLock() {
  try {
    wakeLock = await navigator.wakeLock.request('screen');
    console.log('üîì Wake lock is active');
  } catch (err) {
    console.error('Wake lock error:', err);
  }
}

function releaseWakeLock() {
  if (wakeLock !== null) {
    wakeLock.release().then(() => {
      console.log('üîí Wake lock released');
      wakeLock = null;
    });
  }
}

document.getElementById('keep-awake').addEventListener('change', (e) => {
  if ('wakeLock' in navigator) {
    if (e.target.checked) {
      requestWakeLock();
    } else {
      releaseWakeLock();
    }
  } else {
    alert('Your device does not support screen wake lock.');
  }
});
</script>
{% endblock %}
